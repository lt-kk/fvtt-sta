/* A colored */
.lcars-bar(@color, @colorAccent, @size) {
  display: flex;
  flex-wrap: nowrap;
  grid-gap: @gap;
  padding: 0 @gap;
  border-left: @size solid @color;
  border-right: @size solid @color;
  border-radius: @size / 2;
  margin-bottom: @gap;
  height: @size;
  font-size: calc(@size - 4px);
  line-height: calc(@size - 3px);
  overflow: hidden;

  &:after {
    content: '';
    flex-grow: 1;
    background-color: @colorAccent;
  }
}

.lcars-bar-inner(@color: @sta-color-bg) {
  background-color: @color;
  min-height: unset;
  height: 100%;
  flex-grow: unset;
}

.lcars-border-left(@color, @header-height: 1rem, @width: @gap) {
  border-bottom-left-radius: 0;
  margin-left: -(@width + 2);

  &:before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 2px;
    width: @width;
    height: calc(100% - @header-height);
    background-color: @color;
  }
}


.lcars-border-right(@color, @header-height: 1rem, @width: @gap) {
  border-bottom-right-radius: 0;
  margin-right: -(@width + 2);
  &:before {
    content: '';
    position: absolute;
    bottom: 0;
    right: 2px;
    width: @width;
    height: calc(100% - @header-height);
    background-color: @color;
  }
}


.lcars-edge-left-down(@color, @sizeFrom, @sizeTo) {
  @diff: calc(@sizeFrom - @sizeTo);
  border-bottom-left-radius: 0;
  border-top-left-radius: calc(@sizeFrom + @diff);
  border-left-width: calc(@sizeFrom + @gap);

  &:before {
    content: '';
    position: absolute;
    top: calc(@sizeFrom + @gap);
    left: 0;
    width: @sizeFrom;
    height: @diff;
    background-color: @color;
    mask-image: radial-gradient(circle @diff at 100% @diff, transparent @diff, black 0);
    clip-path: polygon(0 0,
    100% 0,
    100% @diff,
    calc(100% - @sizeFrom + @sizeTo) @diff,
    calc(100% - @sizeFrom + @sizeTo) 100%,
    0 100%);
  }
}

.lcars-edge-right-down(@color, @sizeFrom, @sizeTo) {
  @diff: calc(@sizeFrom - @sizeTo);
  border-bottom-right-radius: 0;
  border-top-right-radius: calc(@sizeFrom + @diff);
  border-right-width: calc(@sizeFrom + @gap);

  &:before {
    content: '';
    position: absolute;
    top: calc(@sizeFrom + @gap);
    right: 0;
    width: @sizeFrom;
    height: @diff;
    background-color: @color;
    mask-image: radial-gradient(circle @diff at 0% @diff, transparent @diff, black 0);
    clip-path: polygon(0 0,
    100% 0,
    100% 100%,
    @diff 100%,
    @diff @diff,
    0 @diff);
  }
}


.lcars-radio(@color: @almost-white, @colorChecked: @sta-color-value ) {
  display: inline-block;
  position: relative;
  top: 0;
  aspect-ratio: 1/1;
  cursor: pointer;
  appearance: none;
  border: none;

  &:after {
    content: '';
    position: absolute;
    height: 100%;
    width: 100%;
    background-color: @color;
    clip-path: circle(30% at 50% 50%);
  }
  &:checked:after {
    background-color: @colorChecked;
  }
}


._lcars-scale-value-color(@colorBase, @colorActive, @colorChecked: @colorActive) {
  border: 1px solid @colorBase;
  //background-color: darken(@colorBase, 10%);
  color: contrast(@colorBase, @almost-white, @almost-black);
  &:hover {
    border-color: if((@colorBase = @colorChecked),
    contrast(@colorBase, @almost-white, @almost-black),
    @colorChecked);
  }
  &:has(~ .checked) {
    border-color: @colorActive;
    background-color: @colorActive;
    color: contrast(@colorActive, @almost-white, @almost-black);

    &:hover {
      border-color: if((@colorActive = @colorChecked),
      contrast(@colorActive, @almost-white, @almost-black),
      @colorChecked);
    }
  }
  &.checked {
    border-color: @colorChecked;
    background-color: @colorChecked;
    color: contrast(@colorChecked, @almost-white, @almost-black);

    &:hover {
      border-color: if((@colorChecked = @colorActive),
      contrast(@colorChecked, @almost-white, @almost-black),
      @colorActive);
    }
  }
}


.lcars-scale-value(
  @colorBase,
  @colorAccent,
  @size
) {
  .lcars-bar(@colorBase, @colorAccent, @size);

  margin-bottom: 2px;
  grid-gap: calc(@gap / 2);

  input, &:after {
    display: none;
  }
  .scale-value {
    flex-grow: 1;
    text-align: center;
    font-weight: bold;
    cursor: pointer;

    ._lcars-scale-value-color(@colorAccent, @color-level-info);

    &.success {
      ._lcars-scale-value-color(@colorAccent, @color-level-info, @color-level-success);
    }

    &.info {
      ._lcars-scale-value-color(@colorAccent, @color-level-info, @color-level-info);
    }

    &.warn {
      ._lcars-scale-value-color(@colorAccent, @color-level-info, @color-level-warning);
    }

    &.error {
      ._lcars-scale-value-color(@colorAccent, @color-level-info, @color-level-error);
    }

    &.fatal {
      ._lcars-scale-value-color(@colorAccent, @color-level-info, @color-level-fatal);
    }
  }
}

.lcars-scale-select(
  @colorBase,
  @colorAccent,
  @size
) {
  position: relative;
  .lcars-bar(@colorBase, @colorAccent, @size);
  &:after {
    display: none;
  }
  > label {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    z-index: -1;
    color: @colorAccent;
    text-align: center;

    &:has(~ :hover) {
      display: none;
      transition-delay: 0.25s;
    }
  }
  .scale-value {
    flex-grow: 1;
    text-align: center;
    font-weight: bold;
    color: transparent;
    cursor: pointer;

    &:hover, &:has(~ :hover) {
      background-color: @colorAccent;
      color: contrast(@colorAccent, @almost-white, @almost-black);
    }

    &.success:hover, &:has(~ .success:hover) {
      background-color: @color-level-success;
      color: contrast(@color-level-success, @almost-white, @almost-black);
    }

    &.info:hover, &:has(~ .info:hover) {
      background-color: @color-level-info;
      color: contrast(@color-level-info, @almost-white, @almost-black);
    }

    &.warn:hover, &:has(~ .warn:hover) {
      background-color: @color-level-warning;
      color: contrast(@color-level-warning, @almost-white, @almost-black);
    }

    &.error:hover, &:has(~ .error:hover) {
      background-color: @color-level-error;
      color: contrast(@color-level-error, @almost-white, @almost-black);
    }

    &.fatal:hover, &:has(~ .fatal:hover) {
      background-color: @color-level-fatal;
      color: contrast(@color-level-fatal, @almost-white, @almost-black);
    }
  }
}